//>>built
define("epi/datetime",["epi","dojo/date","dojo/date/stamp","dojo/date/locale","dojo/_base/lang","dojo/i18n"],function(_1,_2,_3,_4,_5,_6){function _7(_8,_9){var _a=_1.resources.text.day;var _b=_1.resources.text.days;var _c=_1.resources.text.hour;var _d=_1.resources.text.hours;var _e=_1.resources.text.minute;var _f=_1.resources.text.minutes;var _10=_1.resources.text.second;var _11=_1.resources.text.seconds;var _12="";var _13=_9-_8;if(_13<0){return " 1 "+_10;}var _14=Math.floor(_13/1000/60/60/24);var _15=new Date(_13);var _16=_15.getUTCHours();var _17=_15.getMinutes();var _18=_15.getSeconds();if(_14!==0){_12=_12+" "+_14+" "+(_14>1?_b:_a);}if(_16!==0){_12=_12+" "+_16+" "+(_16>1?_d:_c);}if(_17!==0){_12=_12+" "+_17+" "+(_17>1?_f:_e);}if(_12.length>0){return _12;}return " "+_18+" "+(_18>1?_11:_10);};function _19(obj){if(_5.isObject(obj)){for(var _1a in obj){return true;}}return false;};function _1b(obj,_1c){if(_1c){if(obj instanceof Date){return _3.toISOString(obj,{zulu:true});}else{return obj;}}var _1d=_5.clone(obj);for(var _1e in obj){if(obj[_1e] instanceof Date){_1d[_1e]=_3.toISOString(obj[_1e],{zulu:true});}else{if(_19(obj[_1e])){_1d[_1e]=_1b(obj[_1e]);}}}return _1d;};function _1f(_20){return "'"+_20+"'";};return _1.datetime={serverTimeDelta:0,transformDate:function(_21){var _22=(_19(_21)&&!(_21 instanceof Date));var _23=(_22?_1b(_21):_1b(_21,true));return _23;},isDateValid:function(obj){return ((obj&&obj instanceof Date)&&(!isNaN(obj.getTime())));},toUserFriendlyString:function(_24,_25,_26,_27){if(!_24){return "";}if(!(_24 instanceof Date)){_24=new Date(_24);}var _28=_6.getLocalization("dojo.cldr","gregorian",_25);var _29=new Date(),_2a=new Date(_24),_2b=_27?"date":"",_2c="";_29.setHours(0,0,0,0);_2a.setHours(0,0,0,0);if(_2.difference(_29,_24,"year")===0){_2c=_28["dateFormatItem-MMMd"];var _2d=_2.difference(_29,_2a,"day");switch(_2d){case 0:if(_26){return _4.format(_24,{selector:"time",locale:_25});}_2c=_1f(_28["field-day-relative+0"]);break;case 1:_2c=_1f(_28["field-day-relative+1"]);break;case -1:_2c=_1f(_28["field-day-relative+-1"]);break;}}return _4.format(_24,{selector:_2b,datePattern:_2c,locale:_25});},toUserFriendlyHtml:function(_2e,_2f,_30,_31){var _32=this.toUserFriendlyString(_2e,_2f,_30,_31);if(_32===""){return _32;}return "<span class='epi-timestamp'>"+_32+"</span>";},timePassed:function(_33,to){to=to||new Date();return _7(_33,to);},timeToGo:function(_34){return _7(this.serverTime(),_34);},serverTime:function(){return new Date(new Date().getTime()+this.serverTimeDelta);}};});