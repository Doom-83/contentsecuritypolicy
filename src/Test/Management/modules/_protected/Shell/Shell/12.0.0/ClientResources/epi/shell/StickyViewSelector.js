//>>built
define("epi/shell/StickyViewSelector",["epi/dependency","dojo/Deferred","dojo/when","epi/shell/TypeDescriptorManager"],function(_1,_2,_3,_4){var _5="_savedView";var _6=false;function _7(_8,_9){this._profile=_8||_1.resolve("epi.shell.Profile");this._typeDescriptorManager=_9||_4;};_7.prototype.get=function(_a,_b){if(!_6){return null;}var _c=new _2();_3(this._profile.get(_5)).then(function(_d){if(!_d){_c.resolve(null);return;}if(!this._isViewAvailable(_a,_b,_d)){_c.resolve(null);return;}_c.resolve(_d);}.bind(this));return _c.promise;};_7.prototype.save=function(_e,_f,_10){if(!_6){return null;}if(!this._isViewAvailable(_e,_f,_10)){return null;}return this._profile.set(_5,_10);};_7.prototype._isViewAvailable=function(_11,_12,_13){if(_13==="onpageedit"&&!_11){return false;}var _14=this._typeDescriptorManager.getValue(_12,"enableStickyView");if(!_14){return false;}var _15=this._getAvailableViews(_12);if(_15.indexOf(_13)===-1){return false;}return true;};_7.prototype._getAvailableViews=function(_16){var _17=this._typeDescriptorManager.getAndConcatenateValues(_16,"availableViews");if(!_17||_17.length===0){return [];}var _18=this._typeDescriptorManager.getValue(_16,"disabledViews");var _19;if(_18){_19=_17.filter(function(_1a){return _18.every(function(_1b){return _1a.key!==_1b;});});}else{_19=_17;}return _19.map(function(v){return v.key;});};_7.enable=function(){_6=true;};_7.disable=function(){_6=false;};return _7;});