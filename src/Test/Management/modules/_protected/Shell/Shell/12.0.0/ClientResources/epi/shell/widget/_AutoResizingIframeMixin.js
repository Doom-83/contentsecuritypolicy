//>>built
define("epi/shell/widget/_AutoResizingIframeMixin",["dojo/_base/declare","dojo/_base/Deferred","dojo/dom-attr","dojo/dom-style","dojo/has","epi/shell/postMessage","epi/shell/widget/_ScrollbarMeasurementMixin"],function(_1,_2,_3,_4,_5,_6,_7){return _1([_7],{onAfterResize:function(_8){},postCreate:function(){var _9=this,_a=this.name+"/site/resize";this.inherited(arguments);this.own(_6.subscribe(_a,function(_b){_9.contentChange(_b);}));},checkSize:function(){_6.publish("/site/checksize",{},this.getWindow());},onLoad:function(){if(this.isInspectable()){this.setOverflow("hidden");}this.inherited(arguments);},onUnload:function(){this.inherited(arguments);if(this._contentBox){_4.set(this.iframe,{width:this._contentBox.w+"px",height:this._contentBox.h+"px"});}},contentChange:function(_c){if(this._contentBox){this.resize(this._contentBox,true,_c);}},resize:function(_d,_e,_f){var _10=this,def=this._resize(_d,_e,_f);def.then(function(_11){_10.onAfterResize(_11);});return def;},_resize:function(_12,_13,_14){var _15=this._contentBox||{h:0,w:0},_16=this,_17=new _2(),_18=new _2(),_19={h:_12.h,w:_12.w};function _1a(_1b){if(_16.resizeThrottle){clearTimeout(_16.resizeThrottle);_16.resizeThrottle=null;}_16.resizeThrottle=setTimeout(function(){_4.set(_16.iframe,{width:(_1b.w)+"px"});_17.resolve();},50);return _17;};if(_13||(_12&&(_12.h!==_15.h||_12.w!==_15.w))){this._contentBox=_12;_19.w-=this.getScrollbarSize().x;_1a(_19).then(function(){var _1c={h:0,w:0};if(_16.isInspectable()){_1c=_16._setToDocumentSize(_19);}else{if(_14){_4.set(_16.iframe,{width:Math.max(_19.w,_14.w)+"px",height:Math.max(_19.h,_14.h)+"px"});}}_18.resolve(_1c);});}return _18.promise;},_setToDocumentSize:function(_1d){this.setOverflow("visible");var _1e={w:Math.max(this.iframe.contentDocument.body.scrollWidth,_1d.w),h:Math.max(this.iframe.contentDocument.body.scrollHeight,_1d.h)};if(_1e.w>0&&_1e.h>0){_4.set(this.iframe,{width:_1e.w+"px",height:_1e.h+"px"});}this.setOverflow("hidden");_3.set(this.iframe,"data-epi-ipad-ping","pong");return _1e;},setOverflow:function(_1f){var doc=this.getDocument();if(doc&&doc.documentElement&&doc.body){_4.set(doc.documentElement,{overflow:_1f});_4.set(doc.body,{overflow:_1f});}}});});