//>>built
define("epi-cms/contentediting/command/AccessRights",["dojo/_base/declare","dojo/_base/lang","epi/dependency","epi-cms/contentediting/ContentActionSupport","epi/shell/command/_Command","epi/shell/DialogService","epi-cms/ApplicationSettings","epi/i18n!epi/cms/nls/episerver.cms.contentediting.contentdetails.command.accessrights","epi/i18n!epi/shell/nls/admin.security","epi/i18n!epi/shell/nls/edit.editsecurity","epi/i18n!epi/cms/nls/episerver.cms.widget.hierachicallist","epi/i18n!epi/cms/nls/episerver.cms.widget.contentreferences","epi/i18n!epi/shell/nls/button","epi/i18n!epi/nls/episerver.shared","xstyle/css!epi-cms/contentediting/AdminWidgets.css"],function(_1,_2,_3,_4,_5,_6,_7,_8,_9,_a,_b,_c,_d,_e){function _f(_10){return {searchEntities:function(_11){return _10.query({includeRoles:true,includeVisitorGroups:true,name:_11}).then(function(_12){return _12.map(function(x){return {key:x.name,entityType:x.reviewerType};});});}};};return _1([_5],{name:"AccessRights",label:_8.label,tooltip:_8.tooltip,store:null,userNotificationsStore:null,constructor:function(_13){_1.safeMixin(this,_13);this.store=this.store||_3.resolve("epi.storeregistry").get("epi.cms.accessrights");this.userNotificationsStore=this.userNotificationsStore||_3.resolve("epi.storeregistry").get("epi.cms.notification.users");},_execute:function(){require(["epi-cms/contentediting/AdminWidgets"],function(_14){var _15=Object.assign({},_9,_a,_d,_b,_c,{heading:_2.replace(_a.heading,[this.model.contentData.name]),user:_2.replace(_a.user,[_7.userName])});var _16=_f(this.userNotificationsStore);this.store.get(this.model.contentData.contentLink).then(function(_17){var _18=new _14.ContentAccessRights({model:_16,resources:_15,helpLink:_7.userGuideUrl+"#editsecurity",entries:_17.entries,isInherited:_17.isInherited,isInheritedEnabled:_17.isInheritedEnabled,userGroups:_17.userGroups});_6.dialog({dialogClass:"epi-dialog-portrait epi-dialog-portrait__autosize epi-dialog--wide",defaultActionsVisible:true,confirmActionText:_e.action.save,content:_18,title:_a.title}).then(function(){this.store.executeMethod("Save",this.model.contentData.contentLink,{entries:_16.entries,id:this.model.contentData.contentLink,isInherited:_16.isInherited});}.bind(this));}.bind(this));}.bind(this));},_onModelChange:function(){var _19=this.model.contentData,_1a=_4.hasAccess(_19.accessMask,_4.accessLevel.Administer);this.set("canExecute",_19.capabilities.securable&&_1a);}});});